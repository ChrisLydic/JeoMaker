var bootState={preload:function(){game.load.image("progressBar","../assets/progressBar.png")},create:function(){game.stage.backgroundColor=DARK_BLUE,game.state.start("load")}},loadState={preload:function(){var a=game.add.sprite(game.world.centerX,game.world.centerY,"progressBar");a.anchor.setTo(.5,.5),game.load.setPreloadSprite(a),game.load.image("button","../assets/empty.png"),game.load.spritesheet("increment","../assets/increment.png",25,25),game.load.spritesheet("decrement","../assets/decrement.png",25,25),game.load.spritesheet("incrementPlayers","../assets/incrementPlayers.png",50,26)},create:function(){game.state.start("menu")}},menuState={create:function(){this.makeMenu()},makeMenu:function(){function a(){i.fill="#FFFF66",game.state.start("makeMenu")}function b(){j.fill="#FFFF66",game.state.start("playMenu")}function c(){k.fill="#FFFF66",document.getElementById("mHelp").style.display="flex"}function d(){k.fill="#FFFFFF"}function e(){l.fill="#FFFF66",document.getElementById("about").style.display="flex"}function f(){l.fill="#FFFFFF"}var g=game.add.text(game.world.centerX,game.world.centerY-105,"JeoMaker",{font:"60px Arial",fill:"#FFFFFF"});g.anchor.setTo(.5,.5);var h={font:"30px Arial",fill:"#FFFFFF"},i=game.add.text(game.world.centerX,game.world.centerY-30,"Game Editor",h);i.anchor.setTo(.5,.5),i.inputEnabled=!0,i.events.onInputDown.add(a,this);var j=game.add.text(game.world.centerX,game.world.centerY+20,"Play",h);j.anchor.setTo(.5,.5),j.inputEnabled=!0,j.events.onInputDown.add(b,this);var k=game.add.text(game.world.centerX,game.world.centerY+70,"Help",h);k.anchor.setTo(.5,.5),k.inputEnabled=!0,k.events.onInputDown.add(c,this),k.events.onInputDown.add(d,this);var l=game.add.text(game.world.centerX,game.world.centerY+120,"About",h);l.anchor.setTo(.5,.5),l.inputEnabled=!0,l.events.onInputDown.add(e,this),l.events.onInputUp.add(f,this)},hideHelp:function(){document.getElementById("mHelp").style.display="none"},hideAbout:function(){document.getElementById("about").style.display="none"}},makeMenuState={storage:[],name:"",create:function(){if(localStorage.length>0){for(var a=0,b=localStorage.length;b>a;a++)this.storage.indexOf(localStorage.key(a))>-1||this.storage.push(localStorage.key(a));this.nameMenu()}else document.getElementById("nameForm").style.display="flex"},makeStart:function(){game.state.start("make")},gameMenu:function(){var a="30px Arial";new LabelButton("One Round",a,LABEL_WHITE,"center",!1,game,game.world.centerX,game.world.centerY-50,"button",partial(this.makeBoard,!1),this),new LabelButton("Double",a,LABEL_WHITE,"center",!1,game,game.world.centerX,game.world.centerY-10,"button",partial(this.makeBoard,!0),this)},nameMenu:function(){document.getElementById("ddown").style.display="flex";var a=document.getElementById("down");a.innerHTML="";for(var b=0;b<this.storage.length;b++)a.innerHTML=a.innerHTML+"<option>"+this.storage[b]+"</option>";a.innerHTML=a.innerHTML+"<option>New</option>"},loadJeo:function(){var a=document.getElementById("down"),b=a.options[a.selectedIndex].text;document.getElementById("ddown").style.display="none","New"===b?document.getElementById("nameForm").style.display="flex":(currBoard=unobjectify(JSON.parse(localStorage.getItem(b))),this.makeStart())},inputName:function(){var a=document.getElementById("name");this.name=a.elements.nameText.value,document.getElementById("nameForm").style.display="none",this.gameMenu()},makeBoard:function(a){currBoard=new Jeo(this.name,a),this.makeStart()}},playMenuState={storage:[],create:function(){if(currPlayers=[],localStorage.length>0){for(var a=0,b=localStorage.length;b>a;a++)this.storage.indexOf(localStorage.key(a))>-1||this.storage.push(localStorage.key(a));this.nameMenu()}else this.noSaves()},play:function(){var a=document.getElementById("player"),b=a.elements.playerName;currPlayers.length>1?(document.getElementById("players").innerHTML="",b.value="Player Name",document.getElementById("playerForm").style.display="none",game.state.start("play")):(b.value="Not enough players",b.focus())},"return":function(){document.getElementById("noSaves").style.display="none",game.state.start("menu")},noSaves:function(){document.getElementById("noSaves").style.display="flex"},nameMenu:function(){document.getElementById("playForm").style.display="flex";var a=document.getElementById("games");a.innerHTML="";for(var b=0;b<this.storage.length;b++)a.innerHTML=a.innerHTML+"<option>"+this.storage[b]+"</option>"},loadJeo:function(){var a=document.getElementById("games"),b=a.options[a.selectedIndex].text;document.getElementById("playForm").style.display="none",currBoard=unobjectify(JSON.parse(localStorage.getItem(b))),this.playerMenu()},playerMenu:function(){document.getElementById("playerForm").style.display="flex",document.getElementById("player").elements.playerName.select();var a=document.getElementById("players");a.addEventListener("change",playMenuState.viewEditPlayer)},makePlayer:function(){var a=document.getElementById("player"),b=a.elements.playerName,c=a.elements.colors.value;b.value=b.value.trim();for(var d=!1,e=0;e<currPlayers.length;e++)currPlayers[e].name==b.value&&(d=!0);if(0==b.value.length||d)b.value="Invalid player name",b.focus();else{var f=new Player(b.value,c);currPlayers.push(f),b.value="",b.focus(),playMenuState.updatePlayers()}},viewEditPlayer:function(){function a(){var a=document.getElementById("playerHeader"),b=document.getElementById("player"),c=b.elements.playerName,d=b.elements.players.value,e=b.elements.colors,f=0,g=b.elements.addPlayer,h=g.cloneNode(!0);g.parentNode.replaceChild(h,g);var i=b.elements.startGame,j=i.cloneNode(!0);i.parentNode.replaceChild(j,i),a.innerHTML="Edit Player",c.value=d;for(var k=0;k<currPlayers.length;k++)if(currPlayers[k].name==d){f=k;break}if(e.value=currPlayers[f].avatar,h.value="Update",j.value="Delete",h.removeAttribute("onclick"),h.addEventListener("click",playMenuState.changePlayer),j.removeAttribute("onclick"),j.addEventListener("click",playMenuState.deletePlayer),!b.elements.returnPlayer){var l=document.getElementById("playerCont"),m=document.createElement("input");m.type="button",m.name="returnPlayer",m.value="Return",m.addEventListener("click",playMenuState.returnPlayer),l.appendChild(m)}}setTimeout(a,10)},changePlayer:function(){for(var a=document.getElementById("player"),b=a.elements.playerName,c=b.value,d=a.elements.colors.value,e=a.elements.players.value,f=0,g=0;g<currPlayers.length;g++)if(currPlayers[g].name==e){f=g;break}c=c.trim();for(var h=!1,g=0;g<currPlayers.length;g++)currPlayers[g].name==c&&g!=f&&(h=!0);0==c.length||h?(b.value="Invalid player name",b.focus()):(currPlayers[f].edit(c,d),playMenuState.updatePlayers(),playMenuState.returnPlayer())},deletePlayer:function(){for(var a=document.getElementById("player"),b=a.elements.players.value,c=0;c<currPlayers.length;c++)if(currPlayers[c].name==b){currPlayers.splice(c,1);break}playMenuState.updatePlayers(),playMenuState.returnPlayer()},returnPlayer:function(){var a=document.getElementById("playerHeader"),b=document.getElementById("playerCont"),c=document.getElementById("player"),d=c.elements.playerName,e=c.elements.colors,f=c.elements.addPlayer,g=f.cloneNode(!0);f.parentNode.replaceChild(g,f);var h=c.elements.startGame,i=h.cloneNode(!0);h.parentNode.replaceChild(i,h),a.innerHTML="Create Player",d.value="",d.focus(),e.value="#FF0000",g.value="Add",i.value="Start",g.removeAttribute("onclick"),g.addEventListener("click",playMenuState.makePlayer),i.removeAttribute("onclick"),i.addEventListener("click",playMenuState.play);var j=c.elements.returnPlayer;j&&b.removeChild(j)},updatePlayers:function(){var a=document.getElementById("players");a.innerHTML="";for(var b=0;b<currPlayers.length;b++)a.innerHTML=a.innerHTML+"<option  >"+currPlayers[b].name+"</option>"},colorSet:function(){var a=document.getElementById("colors");a.value=a.value}},makeState={Opt:{MAIN:1,HELP:2,SAVE:3,CANCEL:4},buttons:[],create:function(){switch(currBoard.curr){case 1:this.currRound=currBoard.b1;break;case 2:this.currRound=currBoard.b2}this.build()},update:function(){for(var a=0;a<this.buttons.length;a++)this.buttons[a].isOver()},build:function(){layers={bgLayer:this.add.group(),btnLayer:this.add.group(),textLayer:this.add.group()};var a,b,c,d,e,f,g,h,i="aq",j="topic";for(b=0;6>b;b++)for(var c=0;6>c;c++){posX=PADDING*(c+1)+widthBox*c,posY=PADDING*(b+1)+heightBox*b,0===b?(a=LIGHT_BLUE,g=[c],h=j,e=this.currRound.topics[c],f=e.length<13?.3*heightBox:e.length<30?.25*heightBox:.2*heightBox,d={font:f+"px Arial",fill:LABEL_WHITE,align:"center",wordWrap:!0,wordWrapWidth:widthBox}):(a=this.currRound.board[b-1][c].isFull()?PURPLE:BLUE,g=[b-1,c],h=i,e="$"+this.currRound.money[b-1].toString(),d={font:.6*heightBox+"px Arial",fill:LABEL_BLUE});var k=game.add.text(posX+widthBox/2,posY+heightBox/2,e,d);k.anchor.setTo(.5,.5),layers.textLayer.add(k),this.buttons.push(new RectButton(posX,posY,widthBox,heightBox,a,partial(this.promptRunner,h,g)))}var l=game.add.graphics(0,0);layers.bgLayer.add(l),l.beginFill(LIGHT_BLUE),l.drawRect(0,7*PADDING+6*heightBox,w,MENU_BAR_HEIGHT),l.endFill();var m=PADDING/2,n=7*PADDING+6*heightBox+m,o=50,p=200,q=100,r={font:"30px Arial",fill:LABEL_WHITE};if(h=i,g=["F"],currBoard.isDouble){this.buttons.push(new RectButton(w/2-(p+m),n,p,o,BLUE,this.switchBoard));var s;s=currBoard.finalQ.isFull()?PURPLE:BLUE,this.buttons.push(new RectButton(w/2+m,n,p,o,s,partial(this.promptRunner,h,g)));var t=game.add.text(w/2-(p+m)+p/2,n+o/2,"Switch Board",r);t.anchor.setTo(.5,.5),layers.textLayer.add(t);var u=game.add.text(w/2+m+p/2,n+o/2,"Final Q",r);u.anchor.setTo(.5,.5),layers.textLayer.add(u)}else{var s;s=currBoard.finalQ.isFull()?PURPLE:BLUE,this.buttons.push(new RectButton(w/2-p/2,n,p,o,s,partial(this.promptRunner,h,g)));var t=game.add.text(w/2,n+o/2,"Final Q",r);t.anchor.setTo(.5,.5),layers.textLayer.add(t)}this.buttons.push(new RectButton(m,n,q,o,BLUE,partial(this.popUp,"menu"))),this.buttons.push(new RectButton(w-(m+100),n,q,o,BLUE,partial(this.popUp,"save")));var t=game.add.text(m+q/2,n+o/2,"Menu",r);t.anchor.setTo(.5,.5),layers.textLayer.add(t);var v=game.add.text(w-(m+100)+q/2,n+o/2,"Save",r);v.anchor.setTo(.5,.5),layers.textLayer.add(v)},getInput:function(b){var c=document.getElementById(b);"aq"===b?(a=c.elements.answer.value,q=c.elements.question.value,this.updateAQ(a,q)):"topic"===b&&(topic=c.elements.topicText.value,this.updateTopic(topic)),document.getElementById(b+"Form").style.display="none",this.build()},promptRunner:function(a,b){window.ref=b;var c=makeState.currRound,d=document.getElementById(a);"aq"===a&&"F"!==b[0]?(d.elements.answer.value=c.board[window.ref[0]][window.ref[1]].a,d.elements.question.value=c.board[window.ref[0]][window.ref[1]].q):"aq"===a&&"F"===b[0]?(d.elements.answer.value=currBoard.finalQ.a,d.elements.question.value=currBoard.finalQ.q):"topic"===a&&(d.elements.topicText.value=c.topics[window.ref[0]]),document.getElementById(a+"Form").style.display="flex"},updateTopic:function(a){this.currRound.topics[window.ref[0]]=a},updateAQ:function(a,b){"F"===window.ref[0]?currBoard.finalQ.update(a,b):this.currRound.board[window.ref[0]][window.ref[1]].update(a,b)},popUp:function(a){switch(a){case"menu":document.getElementById(a).style.display="flex";break;case"save":currBoard.isFull()?this.save():document.getElementById(a).style.display="flex"}},menuInput:function(a){switch(a){case this.Opt.MAIN:document.getElementById("menu").style.display="none",game.state.start("menu");break;case this.Opt.HELP:document.getElementById("menu").style.display="none",document.getElementById("help").style.display="flex";break;case this.Opt.SAVE:document.getElementById("save").style.display="none",this.save();break;case this.Opt.CANCEL:document.getElementById("menu").style.display="none",document.getElementById("help").style.display="none",document.getElementById("save").style.display="none"}},save:function(){localStorage.setItem(currBoard.name,JSON.stringify(objectify(currBoard)))},switchBoard:function(){game.world.removeAll(),1===currBoard.curr?(currBoard.curr=2,game.state.start("make")):(currBoard.curr=1,game.state.start("make"))}},playState={Opt:{MAIN:1,HELP:2,CANCEL:3},offset:0,buttons:[],create:function(){switch(currBoard.curr){case 1:this.currRound=currBoard.b1;break;case 2:this.currRound=currBoard.b2}this.build()},update:function(){for(var a=0;a<this.buttons.length;a++)this.buttons[a].isOver()},build:function(){layers={bgLayer:this.add.group(),btnLayer:this.add.group(),textLayer:this.add.group()},this.buttons=[];var a,b,c,d,e,f,g=game.add.graphics(0,0);for(layers.bgLayer.add(g),b=0;6>b;b++)for(var c=0;6>c;c++){posX=PADDING*(c+1)+widthBox*c,posY=PADDING*(b+1)+heightBox*b,0===b?(a=LIGHT_BLUE,e=this.currRound.topics[c],f=e.length<13?.3*heightBox:e.length<30?.25*heightBox:.2*heightBox,d={font:f+"px Arial",fill:LABEL_WHITE,align:"center",wordWrap:!0,wordWrapWidth:widthBox},g.beginFill(a),g.drawRect(posX,posY,widthBox,heightBox),g.endFill()):(a=this.currRound.board[b-1][c].isAnswered?PURPLE:BLUE,e="$"+this.currRound.money[b-1].toString(),d={font:.6*heightBox+"px Arial",fill:LABEL_BLUE},this.buttons.push(new RectButton(posX,posY,widthBox,heightBox,a,partial(this.showAnswer,b-1,c))));var i=game.add.text(posX+widthBox/2,posY+heightBox/2,e,d);i.anchor.setTo(.5,.5),layers.textLayer.add(i)}g.beginFill(LIGHT_BLUE),g.drawRect(0,7*PADDING+6*heightBox,w,MENU_BAR_HEIGHT),g.endFill();var j=PADDING/2,k=0,l=7*PADDING+6*heightBox+j,m=50,n=200,o=100,p=50,q={font:"30px Arial",fill:LABEL_WHITE},r=w;if(currBoard.isDouble){k=w-(2*n+o+3*j),this.buttons.push(new RectButton(k,l,n,m,BLUE,this.switchBoard)),k+=n/2;var s=game.add.text(k,l+m/2,"Switch Board",q);s.anchor.setTo(.5,.5),layers.textLayer.add(s),r-=n+j}k=w-(n+o+2*j),this.buttons.push(new RectButton(k,l,n,m,BLUE,this.showFinal)),k+=n/2;var t=game.add.text(k,l+m/2,"Final Q",q);t.anchor.setTo(.5,.5),layers.textLayer.add(t),k=w-(o+j),this.buttons.push(new RectButton(k,l,o,m,BLUE,this.menu)),k+=o/2;var u=game.add.text(k,l+m/2,"Menu",q);u.anchor.setTo(.5,.5),layers.textLayer.add(u),r-=n+o+2*j;var v=10,x=h-60,y=200;this.oneLineFit(r,0)?this.makePlayers(v,x,r,0,y):(r-=j+p,this.makePlayers(v,x,r,this.offset,y),v=r,button1=game.add.button(v,x,"incrementPlayers",partial(this.incPlayers,r),this,1,0))},makePlayers:function(a,b,c,d,e){var f,g;if(g=this.countPlayers(c,d),f=g.length,"finalQ"==e)for(var h=d;f+d>h;h++)e=parseInt(document.getElementById(currPlayers[h].name+String(h)).value),isNaN(e)?e=0:0>e?(e=0,console.log("Negative values are not allowed in final jeopardy wager")):e>currPlayers[h].score&&(e=currPlayers[h].score,0>e&&(e=0),console.log("Values higher than your current score are not allowed in final jeopardy wager")),this.drawPlayer(a,b,h,e),a+=g[h-d];else for(var h=d;f+d>h;h++)this.drawPlayer(a,b,h,e),a+=g[h-d];return f},drawPlayer:function(a,b,c,d){coords=this.drawPlayerScale(a,b,c,1),a=coords[0],b=coords[1];var e=coords[2],f=coords[3],g=coords[4];a+=e.width>MAX_SCORE_WIDTH?e.width+g:MAX_SCORE_WIDTH+g,b-=e.height,button1=game.add.button(a,b,"increment",this.incText,this,1,0),button1.amount=d,button1.index=c,button1.label=f,b+=button1.height,button2=game.add.button(a,b,"decrement",this.decText,this,1,0),button2.amount=d,button2.index=c,button2.label=f},drawPlayerScale:function(a,b,c,d){var e=game.add.graphics(0,0),f=50*d,g=5*d,h={font:String(16*d)+"px Arial",fill:LABEL_WHITE},i={font:String(34*d)+"px Arial",fill:LABEL_WHITE};e.beginFill(Phaser.Color.hexToRGB(currPlayers[c].avatar)),e.drawRect(a,b,f,f),e.endFill(),a+=f+g;var j=game.add.text(a,b,currPlayers[c].name,h);b+=j.height;var k=game.add.text(a,b,String(currPlayers[c].score),i);return[a,b,j,k,g]},countPlayers:function(a,b){for(var c,d=[],e=85,f=30,g=b;g<currPlayers.length;g++){c=e+f;var i=game.add.text(w,h,currPlayers[g].name,{font:"16px Arial"});if(c+=i.width>MAX_SCORE_WIDTH?i.width:MAX_SCORE_WIDTH,i.destroy(),!((a-=c)>=0))break;d.push(c)}return d},oneLineFit:function(a,b){var c=this.countPlayers(a,b);return currPlayers.length-b==c.length?!0:!1},incText:function(a){currPlayers[a.index].setScore(a.amount),a.label.setText(""+currPlayers[a.index].score)},decText:function(a){currPlayers[a.index].setScore(-a.amount),a.label.setText(""+currPlayers[a.index].score)},incPlayers:function(a){var b=playState.countPlayers(a,this.offset);this.offset+=b.length,this.offset==currPlayers.length&&(this.offset=0),this.rebuild()},showAnswer:function(a,b){game.world.removeAll(),game.input.onDown.removeAll(),playState.buttons=[],layers={bgLayer:playState.add.group(),btnLayer:playState.add.group(),textLayer:playState.add.group()};var c=25,d=50,e=c;if(playState.oneLineFit(w,0))e+=d+c;else{for(var f,g=0;!playState.oneLineFit(w,g);)f=playState.countPlayers(w,g),g+=f.length,e+=d+c;f=playState.countPlayers(w,g),e+=d+c}var i=playState.currRound.board[a][b].a;styles={font:"28px Arial",fill:LABEL_WHITE,align:"center",wordWrap:!0,wordWrapWidth:w-100,wordWrapHeight:h-(150+e)};var j=game.add.text(w/2,50,i,styles);j.anchor.setTo(.5,0),layers.textLayer.add(j);var k=playState.currRound.money[a%5],l=0;playState.makePlayersAQ(k,e,l);var m=50,n=200,o=50,p=w/2,q=0,r=h-(o+m),s=r+o/2,t={font:"30px Arial",fill:LABEL_WHITE};q=p-(m+n),playState.buttons.push(new RectButton(q,r,n,o,BLUE,playState.rebuild)),q+=n/2;var u=game.add.text(q,s,"Back",t);u.anchor.setTo(.5,.5),layers.textLayer.add(u),q=p+m,playState.buttons.push(new RectButton(q,r,n,o,BLUE,partial(playState.showQuestion,a,b))),q+=n/2;var v=game.add.text(q,s,"Question",t);v.anchor.setTo(.5,.5),layers.textLayer.add(v)},showQuestion:function(a,b){layers.textLayer.getChildAt(0).setText(playState.currRound.board[a][b].q),layers.textLayer.getChildAt(2).setText("Finish");for(var c=0;c<layers.btnLayer.children.length;c++)layers.btnLayer.children[c].destroy(!0);game.input.onDown.removeAll(),playState.buttons=[];var d=50,e=200,f=50,g=w/2,i=0,j=h-(f+d);i=g-(d+e),playState.buttons.push(new RectButton(i,j,e,f,BLUE,partial(playState.showAnswer,a,b))),i=g+d,playState.buttons.push(new RectButton(i,j,e,f,BLUE,partial(playState.qAnswered,a,b)))},showFinal:function(){game.world.removeAll(),game.input.onDown.removeAll(),playState.buttons=[],layers={bgLayer:playState.add.group(),btnLayer:playState.add.group(),textLayer:playState.add.group()};var a=50,b=200,c=50,d=w/2,e=0,f=h-(c+a),g=f+c/2,i={font:"30px Arial",fill:LABEL_WHITE},j=document.getElementById("finalForm"),k=document.getElementById("finalPlayers"),l=c+2*a,m=(h-l)/h;k.innerHTML="",k.style.width=w;for(var n=0;n<currPlayers.length;n++){var o=document.createElement("div"),p=document.createElement("p"),q=document.createElement("input");p.style.lineHeight="0em",p.style.paddingRight="5px",p.innerHTML=currPlayers[n].name+":",p.style.fontSize="2em",q.type="text",q.placeholder=String(currPlayers[n].score),q.size=6,q.maxLength=10,q.style.fontSize="2em",q.id=currPlayers[n].name+String(n),o.appendChild(p),o.appendChild(q),o.style.margin="20px",o.style.height="3em",o.style.cssFloat="left",k.appendChild(o)}j.style.display="flex",j.style.height=String(100*m)+"%";var r=k.offsetHeight,s=h-(r+l);k.style.marginTop=String(s)+"px";var t=currBoard.finalQ.a;styles={font:"28px Arial",fill:LABEL_WHITE,align:"center",wordWrap:!0,wordWrapWidth:w-100,wordWrapHeight:h-(l+r)};var u=game.add.text(w/2,50,t,styles);u.anchor.setTo(.5,0),layers.textLayer.add(u),e=d-(a+b),playState.buttons.push(new RectButton(e,f,b,c,BLUE,playState.rebuildFinal)),e+=b/2;var v=game.add.text(e,g,"Back",i);v.anchor.setTo(.5,.5),layers.textLayer.add(v),e=d+a,playState.buttons.push(new RectButton(e,f,b,c,BLUE,playState.showFinalQuestion)),e+=b/2;var x=game.add.text(e,g,"Question",i);x.anchor.setTo(.5,.5),layers.textLayer.add(x)},showFinalQuestion:function(){document.getElementById("finalForm").style.display="none",layers.textLayer.getChildAt(0).setText(currBoard.finalQ.q),layers.textLayer.getChildAt(2).setText("Finish");for(var a=0;a<layers.btnLayer.children.length;a++)layers.btnLayer.children[a].destroy(!0);game.input.onDown.removeAll(),playState.buttons=[];var b=50,c=200,d=50,e=w/2,f=0,g=h-(d+b);f=e-(b+c),playState.buttons.push(new RectButton(f,g,c,d,BLUE,playState.showFinal)),f=e+b,playState.buttons.push(new RectButton(f,g,c,d,BLUE,playState.leaderboard));var i=25,j=50,k=i;if(playState.oneLineFit(w,0))k+=j+i;else{for(var l,m=0;!playState.oneLineFit(w,m);)l=playState.countPlayers(w,m),m+=l.length,k+=j+i;l=playState.countPlayers(w,m),k+=j+i}var n=0;playState.makePlayersAQ("finalQ",k,n)},leaderboard:function(){game.world.removeAll(),game.input.onDown.removeAll(),playState.buttons=[],layers={bgLayer:playState.add.group(),btnLayer:playState.add.group(),textLayer:playState.add.group()};var a=50,b=200,c=50,d=w/2,e=0,f=h-(c+a);e=d-(a+b),playState.buttons.push(new RectButton(e,f,b,c,BLUE,playState.rebuild)),e=d+a,playState.buttons.push(new RectButton(e,f,b,c,BLUE,playState.startMenu));var g=4,i=playState.countPlayers(w,0),j=g/2*i[0],k=w/2,l=70,m={font:"30px Arial",fill:LABEL_WHITE},n=game.add.text(k,l,"Leaderboard",m);n.anchor.setTo(.5,.5),l*=2,k-=j,currPlayers.sort(playerSort);var o=25,p=50,q=o,r=0;if(playState.drawPlayerScale(k,l,r,g),r++,playState.oneLineFit(w,r))q+=p+o;else{for(var i,s=r;!playState.oneLineFit(w,s);)i=playState.countPlayers(w,s),s+=i.length,q+=p+o;i=playState.countPlayers(w,s),q+=p+o}console.log(r),playState.makePlayersAQ("leaderboard",q,r)},makePlayersAQ:function(a,b,c){if(playState.oneLineFit(w,c)){for(var d=playState.countPlayers(w,c),e=c,f=c;f<d.length;f++)e+=d[f];e-=30;var g=(w-e)/2,i=h-(b+100);playState.makePlayers(g,i,e+=30,c,a)}else{for(var g=10,i=h-(b+100);!playState.oneLineFit(w,c);){playState.makePlayers(g,i,w,c,a);var e=playState.countPlayers(w,c);c+=e.length,i+=playerHeight+playerPad}playState.makePlayers(g,i,w,c,a)}},menu:function(){document.getElementById("pMenu").style.display="flex"},menuInput:function(a){switch(a){case this.Opt.MAIN:document.getElementById("pMenu").style.display="none",playState.startMenu();break;case this.Opt.HELP:document.getElementById("pMenu").style.display="none",document.getElementById("pHelp").style.display="flex";break;case this.Opt.CANCEL:document.getElementById("pMenu").style.display="none",document.getElementById("pHelp").style.display="none"}},startMenu:function(){game.state.start("menu")},switchBoard:function(){game.world.removeAll(),1===currBoard.curr?(currBoard.curr=2,game.state.start("play")):(currBoard.curr=1,game.state.start("play"))},qAnswered:function(a,b){playState.currRound.board[a][b].updateAnswer(!0),playState.rebuild()},rebuildFinal:function(){document.getElementById("finalForm").style.display="none",playState.rebuild()},rebuild:function(){game.world.removeAll(),playState.build()}},w=window.innerWidth,h=window.innerHeight,game=new Phaser.Game(w,h,Phaser.AUTO,"gameDiv"),currBoard,currPlayers=[],MAX_PLAYERS=7,MAX_SCORE_WIDTH=113,LIGHT_BLUE=39423,BLUE=22015,DARK_BLUE=204,PURPLE=4469708,WHITE=16777215,LABEL_WHITE="#FFFFFF",LABEL_YELLOW="#FFCC33",LABEL_BLUE="#CCFFFF",PADDING=20,MENU_BAR_HEIGHT=70,heightBox,widthBox,calcBoxDim=function(){heightBox=(h-(MENU_BAR_HEIGHT+7*PADDING))/6,widthBox=(w-7*PADDING)/6};calcBoxDim();var partial=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){var c=b.concat(Array.prototype.slice.call(arguments));return a.apply(this,c)}},objectify=function(a){var b;if(a.isDouble){for(var c=[],d=[],e=[],f=[],g=0;5>g;g++)for(var h=0;6>h;h++)c.push(a.b1.board[g][h].a),d.push(a.b1.board[g][h].q);for(var g=0;5>g;g++)for(var h=0;6>h;h++)e.push(a.b2.board[g][h].a),f.push(a.b2.board[g][h].q);b={isDouble:!0,name:a.name,b1:{topics:a.b1.topics,a:c,q:d},b2:{topics:a.b2.topics,a:e,q:f},"final":{a:a.finalQ.a,q:a.finalQ.q}}}else{for(var c=[],d=[],g=0;5>g;g++)for(var h=0;6>h;h++)c.push(a.b1.board[g][h].a),d.push(a.b1.board[g][h].q);b={isDouble:!1,name:a.name,b1:{topics:a.b1.topics,a:c,q:d},"final":{a:a.finalQ.a,q:a.finalQ.q}}}return b},unobjectify=function(a){var b=new Jeo(a.name,a.isDouble);if(a.isDouble){b.b1.topics=a.b1.topics,b.b2.topics=a.b2.topics,b.finalQ.update(a["final"].a,a["final"].q);for(var c=0,d=0;5>d;d++)for(var e=0;6>e;e++)b.b1.board[d][e].update(a.b1.a[c],a.b1.q[c]),c++;c=0;for(var d=0;5>d;d++)for(var e=0;6>e;e++)b.b2.board[d][e].update(a.b2.a[c],a.b2.q[c]),c++}else{b.b1.topics=a.b1.topics,b.finalQ.update(a["final"].a,a["final"].q);for(var c=0,d=0;5>d;d++)for(var e=0;6>e;e++)b.b1.board[d][e].update(a.b1.a[c],a.b1.q[c]),c++}return b},AQ=function(){this.a="Answer",this.q="Question",this.isAnswered=!1};AQ.prototype.constructor=AQ,AQ.prototype.update=function(a,b){this.a=a,this.q=b},AQ.prototype.updateAnswer=function(a){this.isAnswered=a},AQ.prototype.isFull=function(){return"Answer"===this.a||"Question"===this.q?!1:!0};var Board=function(a){this.isDouble=a,this.topics=["Topic","Topic","Topic","Topic","Topic","Topic"],this.board=[];for(var b=0;5>b;b++)this.board[b]=[new AQ,new AQ,new AQ,new AQ,new AQ,new AQ];this.isDouble?this.money=[400,800,1200,1600,2e3]:this.money=[200,400,600,800,1e3]};Board.prototype.constructor=Board,Board.prototype.isFull=function(){for(var a=0;a<this.topics.length;a++)if("Topic"===this.topics[a])return!1;for(var a=0;a<this.board.length;a++)for(var b=0;b<this.board[a].length;b++)if(!this.board[a][b].isFull())return!1;return!0},Board.prototype.isFull=function(){for(var a=0;a<this.board.length;a++)for(var b=0;b<this.board[a].length;b++)this.board[a][b].updateAnswer(!1)};var Jeo=function(a,b){this.name=a,this.curr=1,this.isDouble=b,this.finalQ=new AQ,this.b1=new Board(!1),this.isDouble&&(this.b2=new Board(!0))};Jeo.prototype.constructor=Jeo,Jeo.prototype.updateFinalQ=function(a,b){this.finalQ.update(a,b)},Jeo.prototype.isFull=function(){return this.isDouble?this.finalQ.isFull()&&this.b1.isFull()&&this.b2.isFull():this.finalQ.isFull()&&this.b1.isFull()},Jeo.prototype.resetAnswers=function(){this.isDouble&&this.b2.resetAnswers(),this.b1.resetAnswers()};var Player=function(a,b){this.name=a,this.avatar=b,this.score=0};Player.prototype.constructor=Player,Player.prototype.setScore=function(a){this.score+=a},Player.prototype.edit=function(a,b){this.name=a,this.avatar=b},playerSort=function(a,b){return b.score-a.score};var RectButton=function(a,b,c,d,e,f){this.isIn=!1,this.x=a,this.y=b,this.width=c,this.height=d,this.color=e,this.onDown=f,this.btn=new Phaser.Rectangle(this.x,this.y,this.width,this.height);var g=new Phaser.Rectangle(this.x,this.y,this.width,this.height);this.graphics=game.add.graphics(this.x,this.y),void 0!==typeof layers&&layers.btnLayer.add(this.graphics),this.draw(this.color,1);var h=function(a){g.contains(a.x,a.y)&&f()};game.input.onDown.add(h)};RectButton.prototype.constructor=RectButton,RectButton.prototype.isOver=function(){function a(){4>c?(d.graphics.height-=2,d.graphics.y+=1,d.graphics.width-=2,d.graphics.x+=1,c++):8==c?clearInterval(e):6>c?(d.graphics.height+=2,d.graphics.y-=1,d.graphics.width+=2,d.graphics.x-=1,c++):(d.graphics.height-=2,d.graphics.y+=1,d.graphics.width-=2,d.graphics.x+=1,c++)}function b(){4>f?(g.graphics.height+=2,g.graphics.y-=1,g.graphics.width+=2,g.graphics.x-=1,f++):20==f?clearInterval(h):9>f?(g.graphics.height+=2,g.graphics.y-=1,g.graphics.width+=2,g.graphics.x-=1,f++):14>f?(g.graphics.height-=2,g.graphics.y+=1,g.graphics.width-=2,g.graphics.x+=1,f++):17>f?(g.graphics.height+=2,g.graphics.y-=1,g.graphics.width+=2,g.graphics.x-=1,f++):(g.graphics.height-=2,g.graphics.y+=1,g.graphics.width-=2,g.graphics.x+=1,f++)}if(this.btn.contains(game.input.mousePointer.x,game.input.mousePointer.y)&&!this.isIn){this.draw(16777215,.2);var c=0,d=this;d.graphics.height;var e=setInterval(a,30);this.isIn=!0}else if(!this.btn.contains(game.input.mousePointer.x,game.input.mousePointer.y)&&this.isIn){this.draw(this.color,1),this.isIn=!1;var f=0,g=this;g.graphics.height;var h=setInterval(b,20)}},RectButton.prototype.draw=function(a,b){this.graphics.beginFill(a,b),this.graphics.drawRect(0,0,this.width,this.height),this.graphics.endFill()},game.state.add("boot",bootState),game.state.add("load",loadState),game.state.add("menu",menuState),game.state.add("makeMenu",makeMenuState),game.state.add("playMenu",playMenuState),game.state.add("make",makeState),game.state.add("play",playState),game.state.start("boot");
//# sourceMappingURL=sourceMap.map